<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nebula Tracker</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#6c63ff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Habits">
  <link rel="apple-touch-icon" href="Nebula New Logo.png">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
  <!-- Motivation Toast -->
  <div id="motivation-toast" class="toast hidden">
    <span class="toast-icon">ğŸ‰</span>
    <span class="toast-text"></span>
  </div>

  <!-- Header -->
  <header class="app-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="logo">
          <span class="logo-icon">ğŸ¯</span>
          Nebula Tracker
        </h1>
        <span class="date-badge" id="today-date"></span>
      </div>
      <div class="header-right">
        <nav class="tab-nav">
          <button class="tab-btn active" data-tab="habits">Habits</button>
          <button class="tab-btn" data-tab="dashboard">Dashboard</button>
          <button class="tab-btn" data-tab="calendar">Calendar</button>
        </nav>
        <button class="btn-icon" id="btn-export" title="Export Data">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
            <polyline points="7 10 12 15 17 10" />
            <line x1="12" y1="15" x2="12" y2="3" />
          </svg>
        </button>
      </div>
    </div>
  </header>

  <main class="app-main">
    <div class="tabs-viewport" id="tabs-viewport">
      <div class="tabs-track" id="tabs-track">
        <!-- ============ Habits Tab ============ -->
        <section id="tab-habits" class="tab-content active">
          <!-- Statistics Cards -->
          <div class="stats-row">
            <div class="stat-card">
              <div class="stat-icon">ğŸ“‹</div>
              <div class="stat-body">
                <div class="stat-value" id="stat-total">0</div>
                <div class="stat-label">Total Habits</div>
              </div>
            </div>
            <div class="stat-card accent">
              <div class="stat-icon">âœ…</div>
              <div class="stat-body">
                <div class="stat-value" id="stat-done-today">0</div>
                <div class="stat-label">Done Today</div>
              </div>
            </div>
            <div class="stat-card success">
              <div class="stat-icon">ğŸ“Š</div>
              <div class="stat-body">
                <div class="stat-value" id="stat-percentage">0%</div>
                <div class="stat-label">Completion</div>
              </div>
            </div>
            <div class="stat-card streak">
              <div class="stat-icon">ğŸ”¥</div>
              <div class="stat-body">
                <div class="stat-value" id="stat-best-streak">0</div>
                <div class="stat-label">Best Streak</div>
              </div>
            </div>
          </div>

          <!-- Add Habit -->
          <div class="add-habit-bar">
            <input type="text" id="habit-input" placeholder="Add a new habit..." maxlength="60" autocomplete="off">
            <button class="btn-add" id="btn-add-habit">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <line x1="12" y1="5" x2="12" y2="19" />
                <line x1="5" y1="12" x2="19" y2="12" />
              </svg>
              Add
            </button>
          </div>

          <!-- Habits List -->
          <div class="habits-list" id="habits-list"></div>

          <div class="empty-state hidden" id="empty-state">
            <div class="empty-icon">ğŸ“</div>
            <p>No habits yet</p>
            <span>Start by adding your first habit!</span>
          </div>
        </section>

        <!-- ============ Dashboard Tab ============ -->
        <section id="tab-dashboard" class="tab-content">
          <!-- Dashboard Summary Row -->
          <div class="dash-summary">
            <div class="dash-summary-card">
              <div class="dash-summary-icon blue">ğŸ“ˆ</div>
              <div>
                <div class="dash-summary-value" id="dash-avg-rate">0%</div>
                <div class="dash-summary-label">Avg. Completion (14d)</div>
              </div>
            </div>
            <div class="dash-summary-card">
              <div class="dash-summary-icon green">ğŸ†</div>
              <div>
                <div class="dash-summary-value" id="dash-perfect-days">0</div>
                <div class="dash-summary-label">Perfect Days (14d)</div>
              </div>
            </div>
            <div class="dash-summary-card">
              <div class="dash-summary-icon amber">âš¡</div>
              <div>
                <div class="dash-summary-value" id="dash-total-checks">0</div>
                <div class="dash-summary-label">Total Check-ins</div>
              </div>
            </div>
          </div>

          <!-- Charts Grid -->
          <div class="dashboard-grid">
            <!-- Today's Ring -->
            <div class="chart-card ring-card">
              <h3>Today's Progress</h3>
              <div class="ring-container">
                <canvas id="ring-chart" width="200" height="200" margin="0 auto"></canvas>
                <div class="ring-center">
                  <span class="ring-value" id="ring-value">0%</span>
                  <span class="ring-label">Completed</span>
                </div>
              </div>
              <div class="ring-detail" id="ring-detail">0 / 0 habits</div>
            </div>

            <!-- Line Chart -->
            <div class="chart-card line-card">
              <h3>Daily Progress <small>Last 14 days</small></h3>
              <div class="chart-wrapper">
                <canvas id="line-chart"></canvas>
              </div>
            </div>

            <!-- Bar Chart -->
            <div class="chart-card bar-card">
              <h3>Habit Commitment Ranking</h3>
              <div class="chart-wrapper bar-wrapper">
                <canvas id="bar-chart"></canvas>
              </div>
            </div>
          </div>
        </section>

        <!-- ============ Calendar Tab ============ -->
        <section id="tab-calendar" class="tab-content">
          <div class="calendar-header">
            <button class="btn-icon" id="cal-prev">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="15 18 9 12 15 6" />
              </svg>
            </button>
            <h3 id="cal-month-label"></h3>
            <button class="btn-icon" id="cal-next">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 18 15 12 9 6" />
              </svg>
            </button>
          </div>
          <div class="calendar-grid" id="calendar-grid"></div>
          <div class="calendar-legend">
            <span class="legend-item"><span class="legend-dot full"></span> Full completion</span>
            <span class="legend-item"><span class="legend-dot partial"></span> Partial</span>
            <span class="legend-item"><span class="legend-dot none"></span> Missed</span>
          </div>
        </section>
      </div>
    </div>
  </main>

  <!-- Export Modal -->
  <div class="modal-overlay hidden" id="export-modal">
    <div class="modal">
      <h3>Export Data</h3>
      <p>Choose an export format:</p>
      <div class="modal-actions">
        <button class="btn-secondary" id="export-json">JSON</button>
        <button class="btn-secondary" id="export-csv">CSV</button>
        <button class="btn-ghost" id="export-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Edit Modal -->
  <div class="modal-overlay hidden" id="edit-modal">
    <div class="modal">
      <h3>Edit Habit</h3>
      <input type="text" id="edit-input" maxlength="60" autocomplete="off">
      <div class="modal-actions">
        <button class="btn-primary" id="edit-save">Save</button>
        <button class="btn-ghost" id="edit-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Delete Modal -->
  <div class="modal-overlay hidden" id="delete-modal">
    <div class="modal">
      <h3>Delete Habit</h3>
      <p id="delete-msg">Are you sure you want to delete this habit?</p>
      <div class="modal-actions">
        <button class="btn-danger" id="delete-confirm">Delete</button>
        <button class="btn-ghost" id="delete-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- PWA Install Modal -->
  <div class="modal-overlay hidden" id="install-modal">
    <div class="modal install-modal">
      <div class="install-header">
        <div class="install-icon">ğŸš€</div>
        <h3>Nebula Tracker</h3>
      </div>
      <p>For a better experience, we recommend downloading the app</p>
      <div class="modal-actions">
        <button class="btn-primary" id="install-btn">Download</button>
        <button class="btn-ghost" id="install-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
  <script>
    // Register Service Worker for PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('SW registered: ', registration);
          })
          .catch(registrationError => {
            console.log('SW registration failed: ', registrationError);
          });
      });
    }
  </script>
</body>

</html>